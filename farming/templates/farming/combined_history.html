{% extends 'farming/base.html' %}

{% block title %}History | Smart Farm AI{% endblock %}

{% block content %}

<style>
    .history-container {
        max-width: 1100px;
        margin: 30px auto;
        padding: 20px;
    }

    .section {
        background: #ffffff;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 25px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .section h2 {
        margin-bottom: 15px;
        color: #2e7d32;
        font-size: 22px;
        border-left: 5px solid #4caf50;
        padding-left: 10px;
    }

    .card {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #f9f9f9;
        padding: 12px 16px;
        border-radius: 8px;
        margin-bottom: 10px;
        transition: transform 0.2s ease;
    }

    .card:hover {
        transform: scale(1.01);
        background: #f1f8f4;
    }

    .card span {
        font-weight: 500;
        color: #333;
    }

    .badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 13px;
        color: white;
        background: #4caf50;
    }

    .empty {
        color: #999;
        font-style: italic;
        text-align: center;
        padding: 10px;
    }
</style>

<div class="history-container">

    <!-- ðŸŒ¿ Disease History -->
    <div class="section">
        <h2>ðŸŒ¿ Disease Detection History</h2>

        {% for d in disease_history %}
            <div class="card">
                <span><img src="{{ d.image.url }}" alt="Disease Image" style="width: 100px; height: 100px;"></span>
                <span>{{ d.disease_name }}</span>
                <span class="badge">{{ d.confidence }}%</span>
            </div>
        {% empty %}
            <p class="empty">No disease predictions yet.</p>
        {% endfor %}
    </div>

    <!-- ðŸŒ¾ Crop Recommendation History -->
    <div class="section">
        <h2>ðŸŒ¾ Crop Recommendation History</h2>

        {% for c in crop_history %}
            <div class="card">
                <span>Nitrogen: {{ c.nitrogen }}</span>
                <span>Phosphorus: {{ c.phosphorus }}</span>
                <span>Potassium: {{ c.potassium }}</span>
                <span>Rainfall: {{ c.rainfall }}</span>
                <span>Recommended Crop: {{ c.recommended_crop }}</span>
            </div>
        {% empty %}
            <p class="empty">No crop recommendations yet.</p>
        {% endfor %}
    </div>

    <!-- ðŸ’° Market Price History -->
    <div class="section">
        <h2>ðŸ’° Market Price Predictions</h2>

        {% for m in market_history %}
            <div class="card">
                <span>{{ m.crop }}</span>
                <span class="badge">â‚¹ {{ m.price }}</span>
            </div>
        {% empty %}
            <p class="empty">No market price data yet.</p>
        {% endfor %}
    </div>

</div>

{% endblock %}
